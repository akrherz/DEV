"""Generic plotter"""
from __future__ import print_function
import datetime
from calendar import month_abbr

import numpy as np
from pandas.io.sql import read_sql
from pyiem.plot.use_agg import plt
from pyiem.plot import MapPlot
from pyiem.network import Table as NetworkTable
from pyiem.util import get_dbconn, drct2text

data = """  KMFR   | 2012-06-30 07:27:00-05
 KTWC   | 2013-05-03 16:01:00-05
 KTAE   | 2013-07-01 21:43:00-05
 KSEW   | 2013-09-05 17:26:00-05
 PAJK   | 2013-09-17 07:40:00-05
 KMSO   | 2013-10-25 14:52:00-05
 KREV   | 2013-10-28 08:49:00-05
 KSGX   | 2013-11-30 18:00:00-06
 KTFX   | 2014-02-25 20:15:00-06
 KPDT   | 2014-04-14 10:33:00-05
 KPIH   | 2014-05-31 04:32:00-05
 KBOI   | 2014-05-31 06:46:00-05
 KVEF   | 2014-07-13 17:26:00-05
 KSTO   | 2014-10-31 09:00:00-05
 KPSR   | 2015-07-09 06:50:00-05
 KHNX   | 2016-04-13 07:14:00-05
 KLOX   | 2016-11-13 20:50:00-06
 KPQR   | 2017-05-04 10:06:00-05
 KJAX   | 2017-12-03 19:57:00-06
 KFGZ   | 2017-12-21 07:09:00-06
 KGGW   | 2018-04-06 04:16:00-05
 KMTR   | 2019-02-03 14:42:00-06
 KHGX   | 2019-09-21 13:32:00-05
 KTBW   | 2020-01-05 04:03:00-06
 KLKN   | 2020-01-08 17:51:00-06
 KFSD   | 2020-01-12 05:04:00-06
 KBYZ   | 2020-01-12 16:08:00-06
 KRLX   | 2020-01-13 01:39:00-06
 KSGF   | 2020-01-13 02:10:00-06
 KBTV   | 2020-01-13 02:21:00-06
 KPHI   | 2020-01-13 02:22:00-06
 KILM   | 2020-01-13 02:24:00-06
 KMHX   | 2020-01-13 02:30:00-06
 KLMK   | 2020-01-13 02:31:00-06
 KBOX   | 2020-01-13 02:32:00-06
 KAPX   | 2020-01-13 02:33:00-06
 KPBZ   | 2020-01-13 02:33:00-06
 KGRR   | 2020-01-13 02:37:00-06
 KGID   | 2020-01-13 02:43:00-06
 KCHS   | 2020-01-13 02:45:00-06
 KOKX   | 2020-01-13 02:50:00-06
 KRNK   | 2020-01-13 02:50:00-06
 KBUF   | 2020-01-13 02:54:00-06
 KJKL   | 2020-01-13 03:00:00-06
 KMAF   | 2020-01-13 03:02:00-06
 KILN   | 2020-01-13 03:02:00-06
 KALY   | 2020-01-13 03:07:00-06
 KMRX   | 2020-01-13 03:11:00-06
 KABR   | 2020-01-13 03:12:00-06
 KBGM   | 2020-01-13 03:14:00-06
 KLBF   | 2020-01-13 03:20:00-06
 KLSX   | 2020-01-13 03:21:00-06
 KMLB   | 2020-01-13 03:22:00-06
 KDVN   | 2020-01-13 03:22:00-06
 KLOT   | 2020-01-13 03:22:00-06
 KCLE   | 2020-01-13 03:24:00-06
 KMQT   | 2020-01-13 03:33:00-06
 KARX   | 2020-01-13 03:35:00-06
 KGRB   | 2020-01-13 03:35:00-06
 KLUB   | 2020-01-13 03:43:00-06
 KABQ   | 2020-01-13 03:45:00-06
 KCTP   | 2020-01-13 03:47:00-06
 KFGF   | 2020-01-13 03:49:00-06
 KPAH   | 2020-01-13 03:51:00-06
 KDLH   | 2020-01-13 03:55:00-06
 KMPX   | 2020-01-13 03:58:00-06
 KOAX   | 2020-01-13 03:58:00-06
 KLWX   | 2020-01-13 04:00:00-06
 KBMX   | 2020-01-13 04:04:00-06
 KIND   | 2020-01-13 04:06:00-06
 KRAH   | 2020-01-13 04:08:00-06
 KKEY   | 2020-01-13 04:13:00-06
 KAMA   | 2020-01-13 04:14:00-06
 KICT   | 2020-01-13 04:21:00-06
 KBIS   | 2020-01-13 04:24:00-06
 KMEG   | 2020-01-13 04:25:00-06
 TJSJ   | 2020-01-13 04:26:00-06
 KDMX   | 2020-01-13 04:28:00-06
 KEWX   | 2020-01-13 04:30:00-06
 KMKX   | 2020-01-13 04:30:00-06
 KCRP   | 2020-01-13 04:36:00-06
 KLCH   | 2020-01-13 04:41:00-06
 KFFC   | 2020-01-13 04:42:00-06
 KBRO   | 2020-01-13 04:42:00-06
 KSJT   | 2020-01-13 04:45:00-06
 KEAX   | 2020-01-13 04:58:00-06
 KIWX   | 2020-01-13 04:59:00-06
 KOHX   | 2020-01-13 05:07:00-06
 KDDC   | 2020-01-13 05:16:00-06
 KOUN   | 2020-01-13 05:16:00-06
 KTSA   | 2020-01-13 05:17:00-06
 KEKA   | 2020-01-13 05:19:00-06
 KAKQ   | 2020-01-13 05:24:00-06
 KLIX   | 2020-01-13 05:31:00-06
 KFWD   | 2020-01-13 05:34:00-06
 KGJT   | 2020-01-13 05:50:00-06
 KGSP   | 2020-01-13 05:51:00-06
 KILX   | 2020-01-13 05:52:00-06
 KCYS   | 2020-01-13 05:56:00-06
 KMOB   | 2020-01-13 06:08:00-06
 KSHV   | 2020-01-13 06:08:00-06
 KRIW   | 2020-01-13 06:13:00-06
 KPUB   | 2020-01-13 06:21:00-06
 KUNR   | 2020-01-13 06:26:00-06
 KCAR   | 2020-01-13 06:47:00-06
 KBOU   | 2020-01-13 06:50:00-06
 KDTX   | 2020-01-13 06:50:00-06
 KOTX   | 2020-01-13 07:00:00-06
 KSLC   | 2020-01-13 07:02:00-06
 KEPZ   | 2020-01-13 07:11:00-06
 KHUN   | 2020-01-13 07:11:00-06
 KTOP   | 2020-01-13 07:37:00-06
 KGYX   | 2020-01-13 07:41:00-06
 KCAE   | 2020-01-13 07:56:00-06
 KMFL   | 2020-01-13 08:05:00-06
 KJAN   | 2020-01-13 08:09:00-06
 KLZK   | 2020-01-13 08:32:00-06
 KGLD   | 2020-01-13 08:39:00-06"""


def main():
    """Go Main"""
    vals = {}
    for line in data.split("\n"):
        wfo, valid = line.strip().split("|")
        wfo = wfo.strip()
        year = valid.strip()[:4]
        wfo = wfo[1:]
        if wfo == "JSJ":
            wfo = "SJU"
        vals[wfo] = int(year)
    print(vals)
    # bins = [1, 25, 50, 75, 100, 125, 150, 200, 300]
    bins = np.arange(2011, 2021, 1)
    cmap = plt.get_cmap("PuOr")
    mp = MapPlot(
        sector="nws",
        continentalcolor="white",
        figsize=(12.0, 9.0),
        title=(
            "Year of Last Hazardous Weather Outlook (HWO) Issuance by NWS Office"
        ),
        subtitle=("based on IEM archives"),
    )
    mp.fill_cwas(
        vals,
        bins=bins,
        lblformat="%s",  # , labels=labels,
        cmap=cmap,
        ilabel=True,  # clevlabels=clevlabels,
        units="Year",
    )

    mp.postprocess(filename="test.png")


if __name__ == "__main__":
    main()
